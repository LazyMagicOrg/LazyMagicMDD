  __AppRunnerServiceName__:
    # Generated by __ResourceGenerator__ from __TemplateSource__
    Type: AWS::AppRunner::Service
    Properties:
      ServiceName: !Sub "${AWS::StackName}-__AppRunnerServiceName__"
      SourceConfiguration:
        ImageRepository:
          ImageIdentifier: __ImageUri__
          ImageConfiguration:
            Port: __Port__
            RuntimeEnvironmentVariables:
__RuntimeEnvironmentVariables__
          ImageRepositoryType: ECR
        AutoDeploymentsEnabled: true
      InstanceConfiguration:
        Cpu: __Cpu__
        Memory: __Memory__
      HealthCheckConfiguration:
        Protocol: HTTP
        Path: /health
        Interval: 10
        Timeout: 5
        HealthyThreshold: 2
        UnhealthyThreshold: 3
      AutoScalingConfigurationArn: !Ref __AppRunnerServiceName__AutoScalingConfiguration
      NetworkConfiguration:
        EgressConfiguration:
          EgressType: DEFAULT
    DependsOn:
      - __AppRunnerServiceName__AutoScalingConfiguration

  __AppRunnerServiceName__AutoScalingConfiguration:
    Type: AWS::AppRunner::AutoScalingConfiguration
    Properties:
      AutoScalingConfigurationName: !Sub "${AWS::StackName}-__AppRunnerServiceName__-AutoScaling"
      MaxConcurrency: 100
      MaxSize: 10
      MinSize: 1

  __AppRunnerServiceName__ServiceRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName: !Sub "${AWS::StackName}-__AppRunnerServiceName__-ServiceRole"
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Principal:
              Service: build.apprunner.amazonaws.com
            Action: sts:AssumeRole
      ManagedPolicyArns:
        - arn:aws:iam::aws:policy/service-role/AWSAppRunnerServicePolicyForECRAccess